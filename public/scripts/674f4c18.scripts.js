(function(){var a;a=angular.module("anthCraftApp",["ui.bootstrap","ngRoute","ngCookies","ngResource","imageupload"]).config(["$routeProvider","$compileProvider",function(a,b){b.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|file|blob):|data:image\//),a.when("/",{templateUrl:"views/main.html"}).otherwise({redirectTo:"/"})}]),a.controller("AlertCtrl",["$scope",function(a){return a.alerts=[],a.addAlert=function(){return a.alerts.push({msg:"Another alert!"})},a.closeAlert=function(b){return a.alerts.splice(b,1)},a.$on("app.alert",function(b,c,d){return a.alerts.push({type:c,msg:d})})}]),a.directive("imgUploader",function(){return{restric:"A",transclude:!0,scope:{resType:"=type",resName:"=name",scale:"=previewScale"}}})}).call(this),function(){var a;a=angular.module("anthCraftApp"),a.controller("dashboardCtrl",["$http","$scope","$resource","$rootScope","themeService",function(a,b,c,d,e){return b.themeStatus=function(){return e.status},b.theme=e.themeModel,b.service=e,b.initNewTheme=function(){return b.theme=null,e.init(),b.theme=e.themeModel},b.packageTheme=function(){return e.packageTheme(function(a){return b.theme=a.theme,d.$broadcast("app.alert","info","Theme packed successful!")})},b.resetValue=function(a,b){return e.resetValue(a,b),e.updateView()},b.saveTheme=function(){b.theme.$save(function(){return d.$broadcast("app.alert","info","Theme info saved!")},function(){return d.$broadcast("app.alert","error","Save fail!")})},b.upload=function(b,c,f){var g;return g=new FormData,g.append("image",b,b.name),g.append("themeId",e.themeModel._id),g.append("resType",c),g.append("resName",f),g.append("previewScale",JSON.stringify(e.getPreviewScale(c,f))),a.post("/api/upload",g,{headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){var b;return b={},b[c]={},b[c][f]=a.src,e.updateView(b)}).error(function(){return d.$broadcast("app.alert","error","Server Error!")})}}]),a.controller("wallpaperCtrl",["$scope",function(a){return a.totalItems=64,a.currentPage=4,a.maxSize=5,a.setPage=function(b){return a.currentPage=b},a.bigTotalItems=175,a.bigCurrentPage=1}])}.call(this),function(){var a;a=angular.module("anthCraftApp"),a.controller("previewCtrl",["$scope",function(a){return a.setBg=function(a){return{"background-image":"url("+a+")"}},a.$on("theme.update",function(b,c){return a.theme=c}),a.$on("theme.reset",function(){})}])}.call(this),function(){var a;a=angular.module("anthCraftApp"),a.service("themeService",["$rootScope","$resource","themeConfig",function(a,b,c){var d,e;return d=null,e={status:"uncreated",themeModel:{},packInfo:angular.copy(c.defaultPackInfo),init:function(){var a;return e.status="creating",a={create:{method:"POST"},save:{method:"PUT"},packageUp:{method:"POST",url:"/api/themes/:themeId/package"}},d=b("/api/themes/:themeId",{themeId:"@_id"},a),e.themeModel=d.create({},function(){return e.status="created"},function(){return e.status="uncreated"})},getPreviewScale:function(a,b){return c.previewScales[a][b]},updateView:function(b){var c;for(c in b)e.packInfo[c]=e.packInfo[c]?e.packInfo[c]:{},angular.extend(e.packInfo[c],b[c]);return a.$broadcast("theme.update",e.packInfo,b)},themeUpdate:function(){return a.$broadcast("theme.update",e.packInfo)},resetValue:function(a,b){return e.packInfo[a][b]=c.defaultPackInfo[a][b]},packageTheme:function(a){return e.themeModel.$save(function(b){return d.packageUp({themeId:b._id},e.packInfo,function(b){return e.themeModel.updateTime=b.theme.updateTime,e.themeModel.packagePath=b.theme.packagePath,a.apply(null,arguments)})})}},a.$broadcast("theme.update",e.packInfo,{}),e}])}.call(this),function(){var a;a=angular.module("anthCraftApp"),a.factory("themeConfig",function(){return{previewScales:{wallpaper:{wallpaper:{width:360,height:640,force:!0}}},defaultPackInfo:{wallpaper:{wallpaper:"/../bg/green.png"}}}})}.call(this);